<!-- Patient Information Summary -->
<div class="p-6 bg-gradient-to-r from-blue-50 to-sky-100 rounded-2xl shadow-lg mb-8 text-center">
  <h2 class="text-xl font-bold text-blue-600 mb-6">Patient Information</h2>
  <div *ngIf="loading" class="text-center text-blue-500">Loading...</div>
  <div *ngIf="!loading && motherData">
    <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 xl:grid-cols-9 gap-6 text-sm text-gray-700 text-left max-w-7xl mx-auto">
      <div><span class="font-semibold text-blue-500">Name:</span><br> {{ motherData?.name || 'N/A' }}</div>
      <div><span class="font-semibold text-blue-500">Home Address:</span><br> {{ motherData?.homeAddress || 'N/A' }}</div>
      <div><span class="font-semibold text-blue-500">Age:</span><br> {{ motherData?.age || 'N/A' }}</div>
      <div><span class="font-semibold text-blue-500">G:</span><br> {{ motherData?.g || 'N/A' }}</div>
      <div><span class="font-semibold text-blue-500">P:</span><br> {{ motherData?.p || 'N/A' }}</div>
      <div><span class="font-semibold text-blue-500">Hx:</span><br> {{ motherData?.hx || 'N/A' }}</div>
      <div><span class="font-semibold text-blue-500">LMP:</span><br> {{ motherData?.lmp || 'N/A' }}</div>
      <div><span class="font-semibold text-blue-500">Ultrasound:</span><br> {{ motherData?.ultrasound || 'N/A' }}</div>
      <div><span class="font-semibold text-blue-500">Contact Number:</span><br> {{ motherData?.contactNumber || 'N/A' }}</div>
    </div>
  </div>


</div>

<!-- Record Prenatal Container -->
<div class="p-6 bg-white rounded-xl shadow-lg max-h-full">
  <div class="flex justify-between items-center mb-4">
    <h2 class="text-2xl font-semibold text-blue-600">
      {{ showSubmittedRecords ? 'Submitted Records' : 'Record Prenatal' }}
    </h2>

    <!-- Toggle Button -->
    <button
      class="bg-teal-500 hover:bg-teal-600 text-white px-4 py-2 rounded-xl shadow transition"
      (click)="toggleSubmittedView()"
    >
      {{ showSubmittedRecords ? 'Back to Prenatal Form' : 'Show Submitted Prenatal Records' }}
    </button>
  </div>

  <!-- Form Layout -->


  <div *ngIf="!showSubmittedRecords" class="h-full">
    <div *ngIf="successMessage" class="p-4 mb-4 text-green-800 border border-green-300 rounded-lg bg-green-50 justify-center items-center" role="alert">
      <span class="font-medium">Success!</span> {{ successMessage }}
    </div>

    <div *ngIf="error" class="p-4 mb-4 text-red-800 border border-red-300 rounded-lg bg-red-50" role="alert">
      <span class="font-medium">Error:</span> {{ error }}
    </div>
    <form [formGroup]="pregnancyForm" (ngSubmit)="onSubmit()" class="justify-center items-center h-full">
      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-6 h-full">
        <div *ngFor="let col of columns" class="flex flex-col">
          <label [for]="col.key" class="font-semibold text-xs text-gray-700 mb-1">{{ col.label }}</label>
          <input
            [type]="col.type"
            [formControlName]="col.key"
            [placeholder]="col.placeholder"
            [id]="col.key"
            class="border px-3 py-2 rounded-lg focus:ring-2 focus:ring-blue-400"
          />
        </div>
      </div>

      <div class="flex justify-center mt-4">
        <button
          type="submit"
          [disabled]="pregnancyForm.invalid"
          class="bg-blue-500 text-white px-6 py-2 rounded-xl hover:bg-blue-600 transition"
        >
          Save Record
        </button>
      </div>
    </form>
  </div>

<!-- Submitted Records Section -->
<div *ngIf="showSubmittedRecords" class="mt-6">
  <h3 class="text-lg font-semibold mb-2 text-blue-700">Submitted Records</h3>

  <div *ngFor="let record of records; let i = index" class="bg-white shadow p-4 rounded-lg mb-3 border border-blue-100">
    <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-2">
      <div *ngFor="let col of columns">
        <span class="text-gray-600 text-sm">{{ col.label }}:</span>
        <div class="font-medium text-gray-800">{{ record[col.key] || '-' }}</div>
      </div>
    </div>

    <!-- Action buttons -->
    <div class="flex justify-end gap-3 mt-4">
      <!-- Check if user has permission to edit or delete -->
      <ng-container *ngIf="canEditOrDelete(record); else noPermission">
        <button
          class="px-3 py-1 text-sm font-medium text-blue-700 border border-blue-300 rounded hover:bg-blue-100 transition"
          (click)="onEditRecord(i)">
          Edit
        </button>
        <button
          class="px-3 py-1 text-sm font-medium text-red-700 border border-red-300 rounded hover:bg-red-100 transition"
          (click)="onDeleteRecord(i)">
          Delete
        </button>
      </ng-container>

      <!-- No Permission message -->
      <ng-template #noPermission>
        <span class="cursor-pointer px-3 py-1 text-sm font-medium text-red-500 border border-red-300 rounded hover:bg-red-100 transition">You cannot edit or delete this record.</span>
      </ng-template>
    </div>
  </div>
</div>


</div>
